import{A as e,j as a,b as l,G as t,a as s,c,H as n,w as o,I as d,J as u,o as r,K as i,L as f,M as p,N as _,O as m,P as v,Q as g,S as h,R as y,T as k,U as C,V as b,W as w,X as A}from"./vue-vendor.DLq4fjsJ.js";import{u as I}from"./piggy.DkTaJKTi.js";import{s as j}from"./index-BF4KRMCJ.js";import{u as V,_ as x}from"./_plugin-vue_export-helper.CWDL7LE_.js";function P(e,a=6,l=4){const t=(e??"").trim();return t?t.length<=a+l+3?t:`${t.slice(0,a)}...${t.slice(-l)}`:"--"}const K=x(e({__name:"index",setup(e){const{t:x}=V(),K=I(),{piggyBanks:N,currentChainId:S,alchemyApiKey:M,walletConnectProjectId:T,userAddress:U,isConnected:$}=j(K),D=a(!1),W=l(()=>K.EVM_CHAINS),B=l(()=>W.value.find(e=>e.id===S.value)),E=l(()=>W.value.find(e=>e.id===L.value.chainId)),H=l(()=>Math.max(0,W.value.findIndex(e=>e.id===L.value.chainId))),L=a({chainId:S.value,alchemyApiKey:M.value,walletConnectProjectId:T.value,contractAddress:K.getContractAddress(S.value)}),G=l(()=>{const e=[];return M.value||e.push(x("settings.issue_alchemy")),K.getContractAddress(S.value)||e.push(x("settings.issue_contract")),e}),J=e=>Date.now()/1e3<e.unlockTime,O=()=>{L.value={chainId:S.value,alchemyApiKey:M.value,walletConnectProjectId:T.value,contractAddress:K.getContractAddress(S.value)},D.value=!0},Q=e=>{const a=Number(e.detail.value),l=W.value[a];l&&(L.value.chainId=l.id,L.value.contractAddress=K.getContractAddress(l.id))},R=async()=>{try{K.setAlchemyApiKey(L.value.alchemyApiKey),K.setWalletConnectProjectId(L.value.walletConnectProjectId),K.setContractAddress(L.value.chainId,L.value.contractAddress),await K.switchChain(L.value.chainId),D.value=!1}catch(e){w({title:(null==e?void 0:e.message)||"Settings error",icon:"none"})}},X=async()=>{try{await K.connectWallet()}catch(e){w({title:(null==e?void 0:e.message)||x("wallet.connect_failed"),icon:"none"})}},q=()=>{A({url:"/pages/create/create"})};return(e,a)=>{const l=i,w=m,I=u,j=h,V=C,K=b;return r(),t(d,null,[s(I,{class:"container theme-piggy-bank"},{default:o(()=>[s(I,{class:"header"},{default:o(()=>[s(I,{class:"title-row"},{default:o(()=>[s(l,{class:"title"},{default:o(()=>[f(p(_(x)("app.title")),1)]),_:1}),s(w,{class:"settings-btn",onClick:O},{default:o(()=>[f("âš™ï¸")]),_:1})]),_:1}),s(l,{class:"subtitle"},{default:o(()=>[f(p(_(x)("app.subtitle")),1)]),_:1}),s(I,{class:"status-row"},{default:o(()=>[s(l,{class:"status-chip"},{default:o(()=>{var e;return[f(p((null==(e=B.value)?void 0:e.shortName)||"EVM"),1)]}),_:1}),s(l,{class:v(["status-chip",{connected:_($)}])},{default:o(()=>[f(p(_($)?_(P)(_(U)):_(x)("wallet.not_connected")),1)]),_:1},8,["class"]),_($)?n("",!0):(r(),c(w,{key:0,class:"connect-btn",onClick:X},{default:o(()=>[f(p(_(x)("wallet.connect")),1)]),_:1}))]),_:1})]),_:1}),G.value.length>0?(r(),c(I,{key:0,class:"config-warning"},{default:o(()=>[s(l,{class:"warning-title"},{default:o(()=>[f(p(_(x)("settings.missing_config")),1)]),_:1}),(r(!0),t(d,null,g(G.value,e=>(r(),c(l,{key:e,class:"warning-item"},{default:o(()=>[f(" â€¢ "+p(e),1)]),_:2},1024))),128))]),_:1})):n("",!0),s(j,{"scroll-y":"",class:"content"},{default:o(()=>[0===_(N).length?(r(),c(I,{key:0,class:"empty-state"},{default:o(()=>[s(l,{class:"empty-text"},{default:o(()=>[f("No Piggy Banks yet.")]),_:1}),s(w,{class:"create-btn",onClick:q},{default:o(()=>[f(p(_(x)("create.create_btn")),1)]),_:1})]),_:1})):(r(),c(I,{key:1,class:"grid"},{default:o(()=>[(r(!0),t(d,null,g(_(N),e=>(r(),c(I,{key:e.id,class:"card",onClick:a=>{return l=e.id,void A({url:`/pages/detail/detail?id=${l}`});var l},style:y({borderColor:e.themeColor,boxShadow:`0 0 10px ${e.themeColor}40`})},{default:o(()=>[s(I,{class:"card-header"},{default:o(()=>[s(l,{class:"bank-name"},{default:o(()=>[f(p(e.name),1)]),_:2},1024),s(I,{class:v(["status-badge",{locked:J(e)}])},{default:o(()=>[f(p(J(e)?"ðŸ”’":"ðŸ”“"),1)]),_:2},1032,["class"])]),_:2},1024),s(l,{class:"purpose"},{default:o(()=>[f(p(e.purpose),1)]),_:2},1024),s(I,{class:"progress-section"},{default:o(()=>[s(l,{class:"label"},{default:o(()=>[f(p(_(x)("create.target_label"))+": "+p(e.targetAmount)+" "+p(e.targetToken.symbol),1)]),_:2},1024),s(I,{class:"progress-bar-bg"},{default:o(()=>[s(I,{class:"progress-bar-fill unknown"})]),_:1})]),_:2},1024),s(l,{class:"date-info"},{default:o(()=>[f(p(new Date(1e3*e.unlockTime).toLocaleDateString()),1)]),_:2},1024)]),_:2},1032,["onClick","style"]))),128))]),_:1}))]),_:1}),_(N).length>0?(r(),c(I,{key:1,class:"fab",onClick:q},{default:o(()=>[s(l,{class:"fab-icon"},{default:o(()=>[f("+")]),_:1})]),_:1})):n("",!0)]),_:1}),D.value?(r(),c(I,{key:0,class:"modal-overlay",onClick:a[5]||(a[5]=e=>D.value=!1)},{default:o(()=>[s(I,{class:"modal-content",onClick:a[4]||(a[4]=k(()=>{},["stop"]))},{default:o(()=>[s(l,{class:"modal-title"},{default:o(()=>[f(p(_(x)("settings.title")),1)]),_:1}),s(I,{class:"form-group"},{default:o(()=>[s(l,{class:"label"},{default:o(()=>[f(p(_(x)("settings.network")),1)]),_:1}),s(V,{mode:"selector",value:H.value,range:W.value,"range-key":"name",onChange:Q},{default:o(()=>[s(I,{class:"picker-view"},{default:o(()=>{var e;return[f(p((null==(e=E.value)?void 0:e.name)||_(x)("settings.select_network")),1)]}),_:1})]),_:1},8,["value","range"])]),_:1}),s(I,{class:"form-group"},{default:o(()=>[s(l,{class:"label"},{default:o(()=>[f(p(_(x)("settings.alchemy_key")),1)]),_:1}),s(K,{class:"input-field",type:"password",modelValue:L.value.alchemyApiKey,"onUpdate:modelValue":a[0]||(a[0]=e=>L.value.alchemyApiKey=e),placeholder:_(x)("settings.alchemy_placeholder"),"placeholder-class":"placeholder"},null,8,["modelValue","placeholder"])]),_:1}),s(I,{class:"form-group"},{default:o(()=>[s(l,{class:"label"},{default:o(()=>[f(p(_(x)("settings.walletconnect")),1)]),_:1}),s(K,{class:"input-field",modelValue:L.value.walletConnectProjectId,"onUpdate:modelValue":a[1]||(a[1]=e=>L.value.walletConnectProjectId=e),placeholder:_(x)("settings.walletconnect_placeholder"),"placeholder-class":"placeholder"},null,8,["modelValue","placeholder"])]),_:1}),s(I,{class:"form-group"},{default:o(()=>[s(l,{class:"label"},{default:o(()=>[f(p(_(x)("settings.contract_address")),1)]),_:1}),s(K,{class:"input-field",modelValue:L.value.contractAddress,"onUpdate:modelValue":a[2]||(a[2]=e=>L.value.contractAddress=e),placeholder:"0x...","placeholder-class":"placeholder"},null,8,["modelValue"])]),_:1}),s(I,{class:"modal-actions"},{default:o(()=>[s(w,{class:"cancel-btn",onClick:a[3]||(a[3]=e=>D.value=!1)},{default:o(()=>[f(p(_(x)("common.cancel")),1)]),_:1}),s(w,{class:"submit-btn",onClick:R},{default:o(()=>[f(p(_(x)("common.confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1})):n("",!0)],64)}}}),[["__scopeId","data-v-323e5165"]]);export{K as default};
